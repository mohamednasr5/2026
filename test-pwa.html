<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø§Ø®ØªØ¨Ø§Ø± PWA - Ø£ÙˆØ¨Ø±Ø§ ÙƒØ§ÙÙŠÙ‡</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Cairo', sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: white;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-size: 2rem;
    }
    .section {
      background: rgba(255,255,255,0.15);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 20px;
    }
    .section h2 {
      margin-bottom: 15px;
      font-size: 1.3rem;
      border-bottom: 2px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
    }
    .status {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin: 10px 0;
      background: rgba(0,0,0,0.2);
      border-radius: 10px;
    }
    .status-label {
      font-weight: 600;
    }
    .status-value {
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.9rem;
    }
    .status-value.success {
      background: #4CAF50;
    }
    .status-value.error {
      background: #f44336;
    }
    .status-value.warning {
      background: #ff9800;
    }
    .btn {
      display: block;
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-family: 'Cairo', sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .btn:active {
      transform: scale(0.98);
    }
    .info-box {
      background: rgba(33, 150, 243, 0.2);
      border-right: 4px solid #2196F3;
      padding: 15px;
      border-radius: 10px;
      margin: 10px 0;
    }
    .code {
      background: rgba(0,0,0,0.4);
      padding: 10px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 0.85rem;
      overflow-x: auto;
      margin: 10px 0;
    }
    .test-result {
      margin-top: 10px;
      padding: 10px;
      border-radius: 8px;
      display: none;
    }
    .test-result.show {
      display: block;
    }
    .back-link {
      display: inline-block;
      margin-top: 20px;
      padding: 10px 20px;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      text-decoration: none;
      color: white;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” Ø§Ø®ØªØ¨Ø§Ø± PWA</h1>
    
    <div class="section">
      <h2>ğŸ“± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
      <div class="status">
        <span class="status-label">Manifest Ù…ØªÙˆÙØ±:</span>
        <span class="status-value" id="manifestStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</span>
      </div>
      <div class="status">
        <span class="status-label">Service Worker:</span>
        <span class="status-value" id="swStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</span>
      </div>
      <div class="status">
        <span class="status-label">Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ«Ø¨ÙŠØª:</span>
        <span class="status-value" id="installableStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</span>
      </div>
      <div class="status">
        <span class="status-label">HTTPS ÙØ¹Ù‘Ø§Ù„:</span>
        <span class="status-value" id="httpsStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</span>
      </div>
      <div class="status">
        <span class="status-label">Offline Support:</span>
        <span class="status-value" id="offlineStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</span>
      </div>
    </div>

    <div class="section">
      <h2>ğŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
      
      <button class="btn" onclick="testNotifications()">
        Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
      </button>
      <div class="test-result" id="notifResult"></div>

      <button class="btn" onclick="testCache()">
        Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
      </button>
      <div class="test-result" id="cacheResult"></div>

      <button class="btn" onclick="testShare()">
        Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
      </button>
      <div class="test-result" id="shareResult"></div>

      <button class="btn" onclick="clearCache()">
        Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
      </button>
      <div class="test-result" id="clearResult"></div>
    </div>

    <div class="section">
      <h2>ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²</h2>
      <div class="code" id="deviceInfo"></div>
    </div>

    <div class="section">
      <h2>ğŸ’¡ Ù†ØµØ§Ø¦Ø­</h2>
      <div class="info-box">
        <strong>Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø©:</strong>
        <ul style="margin-top: 10px; margin-right: 20px;">
          <li>ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ HTTPS</li>
          <li>ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù manifest.json</li>
          <li>Service Worker ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø³Ø¬Ù„</li>
          <li>Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø§Ù„Ø£Ø­Ø¬Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­Ø© (192Ã—192 Ùˆ 512Ã—512)</li>
        </ul>
      </div>
    </div>

    <a href="index.html" class="back-link">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  </div>

  <script>
    // Check Manifest
    fetch('manifest.json')
      .then(response => {
        const status = document.getElementById('manifestStatus');
        if (response.ok) {
          status.textContent = 'âœ“ Ù…ØªÙˆÙØ±';
          status.className = 'status-value success';
        } else {
          status.textContent = 'âœ— ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯';
          status.className = 'status-value error';
        }
      })
      .catch(() => {
        const status = document.getElementById('manifestStatus');
        status.textContent = 'âœ— Ø®Ø·Ø£';
        status.className = 'status-value error';
      });

    // Check Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(registrations => {
        const status = document.getElementById('swStatus');
        if (registrations.length > 0) {
          status.textContent = 'âœ“ Ù…Ø³Ø¬Ù„';
          status.className = 'status-value success';
        } else {
          status.textContent = 'âœ— ØºÙŠØ± Ù…Ø³Ø¬Ù„';
          status.className = 'status-value warning';
        }
      });
    } else {
      const status = document.getElementById('swStatus');
      status.textContent = 'âœ— ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…';
      status.className = 'status-value error';
    }

    // Check if installable
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      deferredPrompt = e;
      const status = document.getElementById('installableStatus');
      status.textContent = 'âœ“ Ù†Ø¹Ù…';
      status.className = 'status-value success';
    });

    setTimeout(() => {
      const status = document.getElementById('installableStatus');
      if (!deferredPrompt) {
        status.textContent = 'âœ— Ù„Ø§ / Ù…Ø«Ø¨Øª Ø¨Ø§Ù„ÙØ¹Ù„';
        status.className = 'status-value warning';
      }
    }, 2000);

    // Check HTTPS
    const httpsStatus = document.getElementById('httpsStatus');
    if (window.location.protocol === 'https:') {
      httpsStatus.textContent = 'âœ“ Ù†Ø¹Ù…';
      httpsStatus.className = 'status-value success';
    } else {
      httpsStatus.textContent = 'âœ— Ù„Ø§';
      httpsStatus.className = 'status-value error';
    }

    // Check Offline Support
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.ready.then(() => {
        const status = document.getElementById('offlineStatus');
        status.textContent = 'âœ“ Ù…ÙØ¹Ù‘Ù„';
        status.className = 'status-value success';
      });
    }

    // Test Notifications
    async function testNotifications() {
      const result = document.getElementById('notifResult');
      result.classList.add('show');
      
      if (!('Notification' in window)) {
        result.style.background = 'rgba(244, 67, 54, 0.2)';
        result.textContent = 'âœ— Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­';
        return;
      }

      const permission = await Notification.requestPermission();
      if (permission === 'granted') {
        new Notification('Ø£ÙˆØ¨Ø±Ø§ ÙƒØ§ÙÙŠÙ‡', {
          body: 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰',
          icon: 'icon-192.png'
        });
        result.style.background = 'rgba(76, 175, 80, 0.2)';
        result.textContent = 'âœ“ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ';
      } else {
        result.style.background = 'rgba(255, 152, 0, 0.2)';
        result.textContent = 'âš  ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹';
      }
    }

    // Test Cache
    async function testCache() {
      const result = document.getElementById('cacheResult');
      result.classList.add('show');

      if ('caches' in window) {
        const cacheNames = await caches.keys();
        result.style.background = 'rgba(76, 175, 80, 0.2)';
        result.innerHTML = `âœ“ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© ØªØ¹Ù…Ù„<br>Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Caches: ${cacheNames.length}<br>Ø§Ù„Ø£Ø³Ù…Ø§Ø¡: ${cacheNames.join(', ')}`;
      } else {
        result.style.background = 'rgba(244, 67, 54, 0.2)';
        result.textContent = 'âœ— Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…';
      }
    }

    // Test Share
    async function testShare() {
      const result = document.getElementById('shareResult');
      result.classList.add('show');

      if (navigator.share) {
        try {
          await navigator.share({
            title: 'Ø£ÙˆØ¨Ø±Ø§ ÙƒØ§ÙÙŠÙ‡',
            text: 'ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø§Ø¦Ø¹!',
            url: window.location.href
          });
          result.style.background = 'rgba(76, 175, 80, 0.2)';
          result.textContent = 'âœ“ ØªÙ…Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­';
        } catch (err) {
          result.style.background = 'rgba(255, 152, 0, 0.2)';
          result.textContent = 'âš  ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©';
        }
      } else {
        result.style.background = 'rgba(244, 67, 54, 0.2)';
        result.textContent = 'âœ— Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­';
      }
    }

    // Clear Cache
    async function clearCache() {
      const result = document.getElementById('clearResult');
      result.classList.add('show');

      if ('caches' in window) {
        const cacheNames = await caches.keys();
        await Promise.all(cacheNames.map(name => caches.delete(name)));
        
        if ('serviceWorker' in navigator) {
          const registrations = await navigator.serviceWorker.getRegistrations();
          await Promise.all(registrations.map(reg => reg.unregister()));
        }

        result.style.background = 'rgba(76, 175, 80, 0.2)';
        result.textContent = 'âœ“ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©. Ø£Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©.';
        
        setTimeout(() => {
          window.location.reload();
        }, 2000);
      } else {
        result.style.background = 'rgba(244, 67, 54, 0.2)';
        result.textContent = 'âœ— Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©';
      }
    }

    // Device Info
    const deviceInfo = document.getElementById('deviceInfo');
    deviceInfo.innerHTML = `
Ø§Ù„Ù…ØªØµÙØ­: ${navigator.userAgent}
Ø§Ù„Ù„ØºØ©: ${navigator.language}
Online: ${navigator.onLine}
Ù†ÙˆØ¹ Ø§Ù„Ø§ØªØµØ§Ù„: ${navigator.connection ? navigator.connection.effectiveType : 'ØºÙŠØ± Ù…ØªØ§Ø­'}
Ø§Ù„Ø´Ø§Ø´Ø©: ${screen.width}Ã—${screen.height}
    `.trim();
  </script>
</body>
</html>
